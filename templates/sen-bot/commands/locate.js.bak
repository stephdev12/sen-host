/**
 * ùó¶ùóòùó° Bot - Location Request
 * Utilise le bouton sp√©cial 'send_location' de gifted-btns
 */

import { createRequire } from 'module';
const require = createRequire(import.meta.url);
const { sendInteractiveMessage } = require('gifted-btns');

export async function locateCommand(sock, chatId, message, args) {
    try {
        // R√©action
        await sock.sendMessage(chatId, { react: { text: 'üìç', key: message.key } });

        // Utilisation de sendInteractiveMessage avec le type 'send_location'
        // Documentation: { name: 'send_location', buttonParamsJson: ... }
        await sendInteractiveMessage(sock, chatId, {
            text: `üìç *LOCATION REQUEST*\n\n> Veuillez partager votre position actuelle pour continuer.`,
            footer: "SEN BOT SYSTEM",
            header: "LOCALISATION",
            interactiveButtons: [
                {
                    name: 'send_location',
                    buttonParamsJson: JSON.stringify({
                        display_text: 'üìç PARTAGER MA POSITION'
                    })
                }
            ]
        }, { 
            quoted: message 
        });

    } catch (error) {
        console.error('Locate Error:', error);
        await sock.sendMessage(chatId, { text: '‚ùå Erreur (Gifted-Btns).' }, { quoted: message });
    }
}

export default { locateCommand };
